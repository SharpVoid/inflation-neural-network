import numpy as np
from keras import Sequential
from keras.layers import Dense
from keras.models import load_model

y_train = np.array([0.28, -0.065, -0.005, 0.315, 0, 0.375, 0.35, 0.38, 0.685, 0.255, 0.13, 0.485, 0.25,
                    -0.135, 0.35, 0.345, 0.675, 0.74, 1.255, 0.355, 1.335, 3.555, 1.89, 1.56
])

x_train = np.array(
[[0.0, 0.0, 0.0, 0.0, 0.42685761653592336, 0.5807125305348753, 0.09612310808585497, 0.04214427040456111, 0.0, 0.0013937425348582715, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.006232278724903658, 0.0, 0.0, 0.0, -0.0003094841340972523, 0.00417562297147366, -0.0102509588077064, 0.013606590466067863, 0.008597883597883601, 0.0013160076280109992, 0.010525622735885304, 0.09658122171033245, 0.0, 0.01132137077597593, -0.005238036945613436, 0.016497255364008395, 0.0, -0.0026360878396776517, -0.0041477117899454035], [0.0005734054838686218, 0.0003459828184578509, -0.021969598599028382, 0.03624876996517968, -0.002292780129702247, 0.016940348974209648, -0.000923006603960933, -0.03494208061650948, 0.058175189581237456, 0.010263649512256938, -0.004331358559176259, 9.780148942622263e-05, 0.025516105069308057, 0.01639400018745956, -0.004272458125714921, 0.0013103536159139947, 0.034609935643126914, 0.0008755908722808567, -0.007522110353016354, 0.011471227917015745, 0.005457195322358913, -0.004123322424905812, 0.005432125975213557, -0.013176462009879793, 0.0005534863021510809, 0.002940802542041212, 0.09094827586206897, 0.0031295825629011776, -0.004738501842637111, -0.0020408163265306124, 0.015002735813096264], [0.04522582308289236, 0.009603887559696536, 0.0025772088360361293, 0.0666597798766603, 0.017151130341045328, 0.0004556497266159487, 0.0028569477800033808, 0.005180460065191698, 0.014976607382211389, 0.05781104475628178, 0.01917614255944065, 0.0032910564902755837, 0.002099920614872659, 0.00374041959996423, -0.0068243327493260975, 0.09442578949796464, -0.017972926814062967, 0.03517972567203969, 0.041192730520866694, -0.002217091608451506, -0.004175653382990916, 0.004649613794557043, 0.007181634636872936, 0.004067702453033842, -0.0050142359877106595, 0.004311993679453383, -0.001657179985133453, 0.005492875163164979, 0.0025526831892111073, -0.005400891273001069, -0.0039213145295970715], [0.02505001752722102, -0.0516793879185651, 0.0, 0.010355704826229505, -0.008272126443519835, 0.0019452166659632497, -0.027510719119692703, 0.032308054370723926, 0.021034980248293138, -0.0018483751284971185, 0.0016717514133630011, 0.00911031464520935, -0.009188092869295183, -0.004062893054920153, 0.0, 0.009205195357682808, 0.0, 0.03182751210142254, 0.0, 0.0, 0.01760495990361972, 0.013036475136232158, 0.007158601189355874, 0.0013586104239302337, 0.0026295364257793237, 0.001149743407173736, -0.007539170100720337, 0.0567865481203937, -0.02153062668861519, 0.000517345223199039, 0.007406055591864849], [0.0013524822550488964, 0.02587309204145044, 0.0087295653216201, -0.024109330559836308, 0.0, 0.0038270940178001833, -0.002476025098245617, 0.0, 0.0013056922643139004, 0.006386318139476268, 0.0, 0.0, 0.0012120899850344387, 0.007359906577921287, -0.004008038814047327, 0.0, 0.012537316771745303, 0.0, 0.0, -0.005160249259318572, -0.008464956808116098, 0.0691318625600567, 0.00018945887662586794, 0.0011650195189924642, 0.001007418416677501, -0.001401040236308752, -0.010454448706233573, -0.03766582371964417, 0.0, 0.0, -0.005425817010402429], [0.0, 0.008505506270653987, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.014879666717040696, 0.0067147069359371975, 0.02381625477953576, 0.031082018452599575, 0.03325961648293747, 0.006754301195542821, 0.0017452807437044564, -0.00020590117130251293, 0.0007719411608173844, 0.004106675012084325, -0.001698127864184719, 0.0, 0.0, 0.0, 0.006875687568756876, -0.00363601917559165, -0.00023245002324499985], [-0.0071877646068869705, 4.7757665140074194e-05, 0.0, 0.0, 0.009294214096974156, 0.0013567922937226748, -0.0007340461854749947, 0.0, -0.019276379464772436, 0.01921139134842096, 0.0, 0.0, 0.0, 0.018270791571547942, -0.004175765601654137, -0.0231761575015442, -0.0018401587993975457, 0.00139496621463094, 0.0003730650591895705, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0011906280284696028, -0.1575324248767018, -0.005695959655030219, 0.0038500690422154293, 0.0, 0.0, 0.0, 0.0, -0.0007825810575574797, 0.00021958717610891622, -0.00015856065028916163, -0.0007648858554954095, 0.0, 0.0, 0.0, 0.0, 0.0012379364456649722, 0.0, 0.00210970464135021, 0.06896153439991552, 0.0, 0.0, -7.74423600745755e-05, 0.0, 0.0, -0.0006989683396660812], [0.017072471723851793, 0.0, 0.0, 0.0, 6.389776357826893e-05, 0.0, 0.0, 0.0, 0.0, 0.0, -0.010840108401084007, 0.0005981145924929441, -0.001025641025641022, 0.0, 0.008783058117400475, 0.035015896578315636, 0.040527703640077135, -0.004016482139490317, 0.041693578911384935, 0.07341647079160621, 0.0, 0.04312426616967338, 0.01206707450559561, 0.0028239635940192887, 0.0, 0.0022710816512439146, 0.010789465695559945, 0.0, 0.0, 0.016253185357542065, 0.0033529595907967028], [-9.683082929483681e-05, -0.16619392626343799, 0.0, 0.0, 0.17284933288718363, 0.0, 0.0, 0.0012488234859352489, 0.002946186279625669, -0.0025506279439705586, -0.00017377952385740103, 0.009755486160125894, 0.0, 0.0012299269431466978, 0.0, 0.005708678603102946, 0.020440322218540027, 0.007005013476800071, 0.0, 0.0, 0.0031314474057325533, 0.01130964455501614, -0.004929650354546697, 0.0, -0.001550825397813614, 0.006673794606419223, 0.0, 0.0, 0.00618116033820636, -0.0015649388581112221, 0.07398756581417239], [0.0, 0.05824197650370916, 0.06660822700234471, 0.0, 0.0, 0.08331758212500605, 0.0, 0.0, 0.041740506311880914, 0.0, 0.0, 0.0, 0.0, -0.16313250260820988, 0.008822767360247456, -0.01541641534691307, -0.006392256749872645, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.009677027274339048, 0.0, 0.0, -0.008832931200470538, 0.1063317940430841, 0.02029192091216647], [0.028985288339930797, 0.0, 0.002341468168676075, 0.003317570456708508, 0.006824463711055532, 0.00015074429998116018, 0.0, 0.0, 0.0, 0.0, 0.0, -0.008129266165864962, 0.0, 0.0, 0.015459886125351915, 0.0, 0.0, -0.008669244473394417, 0.0, 0.0, 0.0, 0.0, 0.013188004330949589, 0.005806985520501618, 0.0, 0.0, 0.06892251629588173, 0.0, 0.0, 0.0, 0.0036926064265883378], [0.0, 0.0, 0.0035402474521855957, 0.0, -0.0714285714285714, 0.0, -0.0638887080284911, 0.0, -0.007733480391373806, -0.0024886269564964847, -0.005778034589723474, 0.0064750934138530685, 0.045548503033632066, 0.0, 0.0007630553959685997, -0.021078928914660084, 0.0, 0.0, 0.0014756228639353358, 0.0, 0.0, 0.028524824013555036, 0.033825448210989095, 0.007702638998055245, 0.0, 0.0, 0.0, -0.0096432465382466, -0.0019878330409259294, 0.04782598478096177, 0.035240472237154374], [0.056182255465882756, 0.027842501690519016, 0.017534486487702047, 0.002158629596333499, 0.03620653310400704, -0.005882473618077501, 0.020222379517655018, 0.030082100175469546, 0.034035837481149016, -0.0025349923554488785, 0.0, 0.024504644036246078, 0.00792771093962688, 0.0, 0.07300618591701305, 0.0, -0.11668867439562777, 0.0, 0.05482803578303031, 0.009101005903102909, -0.12111009986050222, -0.000286368843069873, 0.0, 0.24520514610545563, -0.20321035399475085, -0.01140112027399071, -0.20473199852014878, 0.061733791576519564, 0.10445646820798896, -0.13922560956425498, 0.0], [0.23071115512734064, 0.015288361078639366, 0.0, 0.15388922387802562, -0.025775960021884065, -0.0027976296479784012, 0.003860876685218839, -0.002664957955983672, -0.0006692252338690408, 0.003176098430382005, -0.02279706042618409, 0.0, -0.010876722250109726, 0.0, -0.0013091717683316035, -0.004232392791097047, 0.24544326300951635, 0.08938988512354305, 0.008370012701990179, 0.000545447691212995, 0.0688218130092167, -0.1866818883844208, 0.0033393851931210953, -0.004643883434669087, 0.006230870875196506, 0.001982299609734224, -0.20000001155968872, 0.12424699566761899, -0.012777929997342391, 0.00021786492374727592, 0.007944262754740583], [0.016625349320984483, 0.02153889857477528, -0.01341380214915544, -0.14621842385669903, 0.0, 0.0, 0.005847953216374213, -0.0968578301723345, 0.0, 0.0, 0.0, 0.0, -0.050496342788203995, 0.01920534944751956, -0.07640221493902158, 0.11415881314508433, -0.1597163778676606, 0.0, 0.042672136579536835, 0.09843406375090459, -0.036008862113532325, -0.202933139793665, 0.0, 0.0, 0.0, 0.0, -0.0009071493177736367, 0.012118380062305367, 0.0, 0.0010820644737863001, 0.0], [0.0, 0.021254296978495565, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.02460625856750121, 0.007860681485129441, -0.03346717811645775, -0.186580827932436, 0.0, -0.026404008456020964, 0.23721784138427218, -0.014091108973787347, 0.0031552733245663878, 0.003173875437296567, -0.017306964934640002, 0.0, 0.0, -0.019167866064518077, 0.0, 0.00036692678596054383, 0.07218434044231525, 0.0, -0.020606688917136507, 0.0024380344503540574, -0.0036385688295936932, 0.0, -0.1810003356911234], [0.19612193362193361, -0.0008048607741523162, 0.044669758140226806, -0.016589643808696253, 0.0010260381263907492, 0.09000228681248372, -0.12713472485768496, -0.0119429754563527, -0.0027080634418754634, -0.19999999999999996, -0.0033783783783783994, -0.00219780219780219, 0.0, 0.2282993197278912, 0.002868480725623568, 0.02687651331719132, 0.07739182187160513, 0.0, -0.056177650146829405, -0.02370618586477341, 0.014031774877198653, 0.0, 0.003548160156126523, 0.004754302757305151, 0.0, 0.06818181818181812, 0.034537998205818266, 0.0, 0.0, 0.017636113357655737, -0.004380485501576883], [0.004409196816229499, 0.013809925972577908, 0.0, 0.0, -0.005988023952095856, 0.008488541243632188, -0.052664117460466016, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.04153148957839835, -0.013605442176870763, 0.010892983699503894, 0.024307287533286887, 0.7397260273972603, 0.00421940928270037, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.003620964732598153, -0.0065316675749325205, 0.0663738880637091, -0.014399209760687834, 0.023457514571695252, 0.022034499853021878, 0.0, 0.0035460992907800915, 0.025042511688853186, 0.0029653459683947614, 0.0268788364981473, 0.04101518241559021, 0.0, 0.013232125435885358, -0.018338204833626616, 0.0, 0.02777777777777768, 0.06052422360522911, -0.026176369578185404], [0.0, -0.0470374678738808, -0.0035457739922889107, 0.0, 0.0, 0.00027574745088868036, 0.0, 0.0, -0.0017636684303351524, 0.0, 0.0, 0.01041666666666663, -0.010903426791277204, 0.008602150537634357, 0.19083969465648853, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]])
print(x_train.shape[1])
model = Sequential()
model.add(Dense(32, activation='linear', input_shape=(x_train.shape[1],)))
model.add(Dense(64, activation='linear'))
model.add(Dense(1, activation='linear'))  # sigmoid, т.к. данные от 0 до 1

print(model.summary())  # архитектура нашей модели

model.compile(optimizer='rmsprop', loss='mse', metrics=['mae'])

history = model.fit(x_train,
                    y_train,
                    epochs=600,
                    validation_split=0.8,
                    verbose=2
                    )

print(model.evaluate(x_train, y_train))
x = np.array([x_train[0]])
print(model.predict(x))